<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="Iframe.css">
    <link rel="stylesheet" id="themestyle" href=".css">
    <link href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet'>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="manifest" href="ma.json">
    <link rel="prefetch" href="index.html" />
    <title>IFRAME</title>
    <script>
    const useProxy = localStorage.getItem('useProxy') === 'true';
    const proxyOption = localStorage.getItem('proxyOption');
    const pluginUrls = JSON.parse(localStorage.getItem('websitePlugins')) || [];
    
    pluginUrls.forEach(pluginUrl => {
      const script = document.createElement('script');
      
      if (useProxy) {
        if (proxyOption && proxyOption.toLowerCase() === "dynamic") {
          script.src = `${window.location.origin}/service/route?url=${(pluginUrl)}`;
        } else {
          script.src = `${window.location.origin}/uv/service/${Ultraviolet.codec.xor.encode(pluginUrl)}`;
        }
      } else {
        script.src = pluginUrl;
      }
      
      const userframe = document.getElementById("iframeurl");

      if (userframe) {
        const iframeDocument = userframe.contentWindow.document;
        iframeDocument.head.appendChild(script);
        console.log(`Plugin injected into the iframe: ${pluginUrl}`);
      } else {
        console.log("iframeurl element not found.");
      }
    });
    </script>
</head>
<body>
    <div class="topnav">
        <div class="left">
            <i onclick="history.back()" class='bx bx-chevron-left'></i>
            <i onclick="history.forward()" class="bx bx-chevron-right"></i>
            <i onclick="window.location.href = './iframe.html'" class='bx bx-refresh medium'></i>
            <i onclick="window.location.href = 'index.html'" class='bx bx-home-alt small'></i>
            <img id="imageapp" src="">
            <p id="appname">App</p>
        </div>
        <div class="right">
            <i onclick="document.getElementById('iframeurl').contentWindow.location.reload(true);" class='bx bx-refresh medium'></i>
            <a href="" id="external"><i class='bx bx-link-external small'></i></a>
            <i onclick="window.location.href = './settings.html'" class='bx bx-cog small' ></i>
            <i onclick="window.location.href = 'index.html'" class='bx bx-exit small'></i>
        </div>
        <script>
            document.getElementById("appname").innerHTML = localStorage.getItem('appname');
            document.getElementById("external").href = localStorage.getItem('iframeurl');
            document.getElementById("imageapp").src = localStorage.getItem('image');
        </script>
    </div>
    <div class="iframe">
      <iframe id="iframeurl" src="" style="border: 0; height: calc(100vh - 50px); left: 0; position: absolute; top: 0; width: 100%; bottom: 0; margin-top: 50px;"></iframe>
        <script>
            document.getElementById("iframeurl").src = localStorage.getItem('iframeurl');
        </script>
    </div>
</body>
</html>
<script src="panic.js"></script>
<script src="addon.js"></script>
